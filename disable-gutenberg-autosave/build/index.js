(()=>{"use strict";var e,t={714:(e,t,a)=>{const s=window.wp.i18n,i=window.wp.element,r=window.wp.editor,n=window.wp.components,o=window.wp.compose,l=window.wp.data,u=window.wp.plugins,v=window.wp.apiFetch;var d=a.n(v);const b=window.ReactJSXRuntime,g=[{label:(0,s.__)("10 seconds","disable-gutenberg-autosave"),value:10},{label:(0,s.__)("30 seconds","disable-gutenberg-autosave"),value:30},{label:(0,s.__)("1 minute","disable-gutenberg-autosave")+" ("+(0,s.__)("default","disable-gutenberg-autosave")+")",value:60},{label:(0,s.__)("5 minutes","disable-gutenberg-autosave"),value:300},{label:(0,s.__)("10 minutes","disable-gutenberg-autosave"),value:600},{label:(0,s.__)("30 minutes","disable-gutenberg-autosave"),value:1800},{label:(0,s.__)("Disabled","disable-gutenberg-autosave"),value:99999}];class p extends i.Component{constructor(e){super(e),this.state={interval:0,error:!1},this.apiGetInterval=this.apiGetInterval.bind(this),this.apiSetInterval=this.apiSetInterval.bind(this),this.editorUpdateInterval=this.editorUpdateInterval.bind(this)}apiGetInterval(){d()({path:"/disable-gutenberg-autosave/v1/interval"}).then((e=>{this.setState({interval:e,error:!1})}),(e=>{this.setState({interval:99999,error:e.message})}))}apiSetInterval(){this.state.error||d()({path:"/disable-gutenberg-autosave/v1/interval",method:"POST",data:{interval:parseInt(this.state.interval)}})}editorUpdateInterval(){this.props.updateEditorSettings({...this.props.editorSettings,autosaveInterval:parseInt(this.state.interval)})}componentDidMount(){this.apiGetInterval()}componentDidUpdate(e,t){this.state.interval&&(t.interval&&0!==t.interval&&t.interval!==this.state.interval&&this.apiSetInterval(),this.props.editorSettings.autosaveInterval&&this.props.editorSettings.autosaveInterval!==this.state.interval&&this.editorUpdateInterval())}render(){return(0,b.jsxs)(i.Fragment,{children:[(0,b.jsx)(r.PluginSidebarMoreMenuItem,{target:"disable-gutenberg-autosave-sidebar",children:(0,s.__)("Disable Gutenberg Autosave","disable-gutenberg-autosave")}),(0,b.jsx)(r.PluginSidebar,{name:"disable-gutenberg-autosave-sidebar",title:(0,s.__)("Autosave settings","disable-gutenberg-autosave"),children:(0,b.jsxs)(n.PanelBody,{className:"disable-gutenberg-autosave-settings",children:[!this.state.interval&&(0,b.jsx)("p",{children:(0,s.__)("Loading...","disable-gutenberg-autosave")}),!!this.state.interval&&this.state.error&&(0,b.jsxs)(i.Fragment,{children:[(0,b.jsx)("h2",{className:"disable-gutenberg-autosave-header",children:(0,s.__)("API error:","disable-gutenberg-autosave")}),(0,b.jsx)("p",{className:"disable-gutenberg-autosave-error",children:this.state.error}),(0,b.jsx)("p",{children:(0,s.__)("Autosave is disabled anyway, but you cannot set custom intervals.","disable-gutenberg-autosave")}),(0,b.jsx)(n.Button,{className:"button button-primary",onClick:()=>{this.setState({interval:0,error:!1}),this.apiGetInterval()},children:(0,s.__)("Try again","disable-gutenberg-autosave")})]}),!!this.state.interval&&!this.state.error&&(0,b.jsx)(n.RadioControl,{label:(0,s.__)("Autosave interval","disable-gutenberg-autosave"),options:g,selected:parseInt(this.state.interval),onChange:e=>this.setState({interval:parseInt(e)})}),(0,b.jsx)("br",{}),(0,b.jsx)("strong",{children:(0,s.__)("Editor status","disable-gutenberg-autosave")}),(0,b.jsxs)("ul",{style:{marginTop:4},children:[(0,b.jsx)("li",{children:`${(0,s.__)("Is edited post dirty","disable-gutenberg-autosave")}: ${this.props.isDirty}`}),(0,b.jsx)("li",{children:`${(0,s.__)("Is edited post autosaveable","disable-gutenberg-autosave")}: ${this.props.isAutosaveable}`}),(0,b.jsx)("li",{children:`${(0,s.__)("Is autosaving","disable-gutenberg-autosave")}: ${this.props.isAutosaving}`}),(0,b.jsx)("li",{children:`${(0,s.__)("Autosave interval","disable-gutenberg-autosave")}: ${this.props.interval}`}),(0,b.jsx)("li",{children:`${(0,s.__)("Local autosave interval","disable-gutenberg-autosave")}: ${this.props.localInterval}`})]}),(0,b.jsx)(n.Button,{isPrimary:!0,text:(0,s.__)("Autosave now","disable-gutenberg-autosave"),disabled:this.props.isAutosaving,isBusy:this.props.isAutosaving,onClick:()=>{this.props.autosave()}})]})})]})}}const h=(0,o.compose)([(0,l.withSelect)((e=>{const{isEditedPostDirty:t,isEditedPostAutosaveable:a,isAutosavingPost:s,getEditorSettings:i}=e("core/editor"),r=i();return{editorSettings:r,isDirty:t(),isAutosaveable:a(),isAutosaving:s(),interval:r.autosaveInterval,localInterval:r.__experimentalLocalAutosaveInterval||r.localAutosaveInterval}})),(0,l.withDispatch)((e=>({updateEditorSettings:e("core/editor").updateEditorSettings,autosave:e("core/editor").autosave})))])(p);(0,u.registerPlugin)("wsd-disable-gutenberg-autosave",{icon:"backup",render:h})}},a={};function s(e){var i=a[e];if(void 0!==i)return i.exports;var r=a[e]={exports:{}};return t[e](r,r.exports,s),r.exports}s.m=t,e=[],s.O=(t,a,i,r)=>{if(!a){var n=1/0;for(v=0;v<e.length;v++){for(var[a,i,r]=e[v],o=!0,l=0;l<a.length;l++)(!1&r||n>=r)&&Object.keys(s.O).every((e=>s.O[e](a[l])))?a.splice(l--,1):(o=!1,r<n&&(n=r));if(o){e.splice(v--,1);var u=i();void 0!==u&&(t=u)}}return t}r=r||0;for(var v=e.length;v>0&&e[v-1][2]>r;v--)e[v]=e[v-1];e[v]=[a,i,r]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};s.O.j=t=>0===e[t];var t=(t,a)=>{var i,r,[n,o,l]=a,u=0;if(n.some((t=>0!==e[t]))){for(i in o)s.o(o,i)&&(s.m[i]=o[i]);if(l)var v=l(s)}for(t&&t(a);u<n.length;u++)r=n[u],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(v)},a=globalThis.webpackChunkdisable_gutenberg_autosave=globalThis.webpackChunkdisable_gutenberg_autosave||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var i=s.O(void 0,[350],(()=>s(714)));i=s.O(i)})();